\documentclass{article}

\input{../_NoteHead.tex}
\newcommand{\bico}[3]{{#2}\backslash {#1}\slash {#3}}


\title{Bruhat Decomposition for \texorpdfstring{$\SL_n(k)$}{SLn(k)}}
\author{}

\begin{document}
\maketitle

The goal would be to prove the affine Bruhat decomposition, and to deduce from this the Cartan decompostion. The affine Bruhat decomposition is a special case of the Bruhat decomposition, for groups with Tits systems whose associated Weyl group is an affine Coxeter group. In other words, the main question would be to prove the affine Bruhat decomposition (decomposition of the group as a partition of double classes modulo an alcove stabilizer - called an Iwahori subgroup), to interpret it geometrically and to explain how to deduce the Cartan decomposition from the affine Bruhat decomposition (by seeing a maximal compact subgroup as a finite union of double cosets modulo an Iwahori subgroup). Iwasawa decomposition is a different story ; obe way to prove it consists in showing that $\SL(n,k^\circ)$ acts transitively on maximal flags.Â 

Throughout this note, $k$ will be a non-archimedean local field with residue field of size $q$ and the absolute value normalized by $|\varpi| = q^{-1}$ for any uniformizer $\varpi$.

\section{Buildings}
We clarify some notations first.
Combinatorically, we have the following definitions.
\begin{itemize}
\item A \textbf{simplex} = a point, a segment, a trianle, (just think of them as in Euclidean geometry) ...
Formally, an \textbf{$n$-simplex} (or a simplex of \textbf{dimension} $n$) $\sigma$ is a set with $(n + 1)$-elements, in which the elements are called the \textbf{vertices} of $\sigma$.

\item A \textbf{face} $\tau$ of a simplex $\sigma$ is a subset $\tau\subset\sigma$.
A face itself is a simplex,
and the \textbf{codimension} of $\tau$ in $\sigma$ is $\#(\sigma\sminus\tau)$.

\item A \textbf{facet} or a \textbf{panel} is a face of codimension $1$.
Two simplices \textit{of the same dimension} are \textbf{adjacent},
if they intersect at a common facet.

\item A \textbf{simplicial complex} $X$ with \textbf{vertices} $V$ is a set of simplices $\sigma\subset V$, i.e., every $\sigma\in X$ is a finite subset of $V$,
such that every face of $\sigma\in X$ is also in $X$.
For convenience, we require furthur that $\bigcup X = V$.

\item A morphism $X\to Y$ of simplicial complexes is a \textbf{cellular map}, i.e. a map of vertices $f : \bigcup X\to\bigcup Y$,
such that for each simplex $\sigma\in X$,
its image $f(\sigma)\in Y$ is a simplex of the same dimension.


\item If $\sigma$ is a simplex, the \textbf{closure} of $\sigma$ is the simplicial complex $\bar\sigma := $ the powerset of $\sigma$.

\item An \textbf{alcove}\footnote{
    The notion ``alcove'' may be specific to affine buildings, like a group action?
} or a \textbf{chamber} $c$ in a simplicial complex $X$ is a maximal simplex in $X$, i.e. $c$ is not a face of any other simplex.

\item A \textbf{gallery} connecting two alcoves $c$ and $c'$ is a sequence $c = c_0, c_1, \dots, c_n = c'$ such that $c_i$ is adjacent to $c_{i+1}$.
A \textbf{chamber complex} is a simplicial complex such that every two chambers are connected by a gallery.

\item Let $X$ be a chamber complex. Fix an alcove $c$ in $X$.
A \textbf{typing} of \textbf{colouring}
of $X$ is a morphism $\lambda : X\to c$.
Equivalently\footnote{
    It may require more condition on $X$ for this equivalence?
}, we fix a colouring of the panels of $c$,
and propagate it to the whole complex $X$,
so that: any panel of an alcove is coloured,
and two adjacent panels (from different alcoves) have different colours.


\end{itemize}
However, in this note, we will ({\color{red} really? we need the interiors to talk about things like intervals or points (continuous parameter?) but it produces much trouble when talking combinatoric things}) add in all the \textbf{interiors} of simplices/complexes,
and define a simplex to be the interior, and a complex to be the union all vertices and interiors. In particular, a simplex $\sigma$ of a simplicial complex $X$, in our sense, is a \textit{subset} of $X$.
For example, an $1$-simplex is now literally a segment with two endpoints included.

\subsection{Affine Buildings}

Fix an affine tiling $\Sigma = (E, W)$ in a Euclidean space $E$ with tiling group $W$.
This means that $E$ carries a tiling by one kind of polyhedron\footnote{
    It is a simplex for $\SL_n$.
} $\sigma$.
For each facet of a polyhedron $\sigma$,
the reflection along that facet is an automorphism of $E$ preserving the tiling.
We require $W = \gene{S}$ to be the group generated by the set $S$ of such reflections for \textit{one} polyhedrons (equivalent, $W$ is generated by \textit{all} reflections).

We could regard such a tiling as a chamber complex,
where alcoves are the polyhedrons.
Given an alcove $\sigma\subset E$,
we can colour this alcove then propagate it using $W$ to the whole complex $E$.
\begin{lemma}\label{unicity of colouring on appartments}
    The colouring of $E$ is unique,
    and $W$ is the group of type-preserving automorphisms.
\end{lemma}
This colouring can also be viewed as a map \[\lambda : E\to \mathcal{P}(S)\]
defined as follows. Each facet $\tau$ is assigned with a unique reflection $s\in S$, and we define the colour of $\tau$ to be $s$.
Any point $x\in X$ is in the intersection of facets with different type,
so we can define $\lambda(x)\in\mathcal{P}(S)$
to be the collection of the colours of facets containing that point.
(Need refinement!)

An \textbf{affine building} of type $\Sigma$ is a poly-simplicial\footnote{
    For $\SL_n$, the building is a simplicial complex, so let's skip the definition of poly-simplicial complex for now.
} complex $X$,
covered by sub-complexes $\A$ isomorphic to $\Sigma$, called \textbf{appartments}, such that:\begin{enumerate}[(i)]
    \item Any two points in $X$ are contained in a same appartment.
    \item Given any two appartments $\A$ and $\A'$, there is an isomophism $\A\isomto \A'$ fixing $\A\cap\A'$. 
\end{enumerate}
(How to define global colouring?)


\begin{theorem}\label{basic properties of a building}
    Let $X$ be a building of type $(E, W)$.
    Given a $W$-invariant distance $d_E$ on $E$,
    there is a distance $d$ on $X$ as follows: for $x, y\in X$, pick an appartment $\A$ containing $x$ and $y$ with an isomophism $\A\simeq E$,
    and we define $d(x, y) := d_E(x, y)$.
    This map $d$ is a well-defined distance with the following properties.\begin{enumerate}[(i)]
        \item $(X, d)$ is complete.
        \item Given an inclusion $c\subset\A$ of an alcove into an appartment,
        there is a \textit{unique} $1$-Lipschitz retraction\[\rho = \rho_{\A, c} : X\to\A,\]
        i.e. $\rho|_{\A} = \Id_\A$ and \[d(\rho(x), \rho(y))\le d(x, y),\quad\forall x, y\in X,\]
        with ``='' holds if $x\in \bar{c}$.
        Moreover, for any appartment $\A'\supset c$, \[\rho|_{\A'} : \A'\to\A\]is the unique isomophism fixing $c$.
        \item For any two points $x, y\in X$,
        \[[x, y] := \{z\in X\mid d(x, z) + d(z, y) = d(x, y)\} \subset\A\]
        for any appartment $\A$ containing $x$ and $y$.
        \item For $x, y\in X$ and $0\le t\le 1$,
        we denote by \[(1 - t)x + ty\in [x, y]\]
        the unique point $z$ such that $d(x, z) = t\cdot d(x, y)$.
        Then the map \[X\times X\times [0, 1]\to X\quad (x, y, t)\mapsto (1 - t)x + ty\]
        is continuous, and $X$ is contractible.
    \end{enumerate}
\end{theorem}

Let $\mathbb{G}$ be a simply connected semi-simple linear group over $k$.
The Bruhat-Tits building $X = X(\mathbb{G}, k)$
is an affine building, on which $G = \mathbb{G}(k)$ acts by cellular and isometric automorphisms,
such that the $G$-action is 
\begin{itemize}
    \item type-preserving,
    \item proper: the stabilizer of any face\footnote{
        Facets of alcoves?
    } is compact,
    \item strongly transitive\footnote{
        Note that for our ``geometric'' building, the $G$-action is not set-theoretically transitive. For example, it cannot send a vertex to a non-vertex point.
    }: the $G$-action is transitive on the set of all inclusion relations $c\subset\A$, where $c$ is an alcove and $\A$ is an appartment.
\end{itemize}

\subsection{Bruhat decomposition}



Fix an appartment $\A$ and an alcove $c\subset\A$.
We define \begin{align*}
    B &:= \{g\in G\mid gc = c\} =\stab_{G}(c),\\
    N &:= \{g\in G\mid g\A = \A\} = \stab_{G}(\A),\\
    T &:= \{g\in G\mid gx = x,\forall x\in\A\}.
\end{align*}
Recall that $W = \gene{S}$ is the group of type preserving automorphisms of $\A$, where $S$ is the set of reflections along the facets of $c$.
% For any $n\in N$,
% there is some $w\in W$ with $nc = wc$ by the transitivity.
% Since both $n$ and $w$ are type-preserving,
% they must agree on $\A$,
So for any $n\in N$,
there is some $w\in W$ such that $n|_{\A} = w$, and thus we have an epimorphism $N\surject W$ with kernel $T$.
Also by the type-preserving property(not clear! why can'it such an element send an alcove different from $c$ to another?),
$B\cap N = T$.

Take $S'\subset S$ and let $a$ be the face of $c$ with colour $S\sminus S'$,
so that \[W' := \stab_W(a) = \gene{S'}.\]
Let \[P_{S'} := \stab_G(a).\]
For $g\in P_{S'}$,
choose an appartment $\A'$ containing $c$ and $gc$.
By strong transitivity,
there is some $b\in B$ with $b\A' = \A$.
The alcove $bgc\subset\A$, so $bgc = wc$ for a unique $w\in W$.
Thus $\tilde{w}^{-1}bg\in B = \stab_G(c)$,
where $\tilde{w}\in N$ is any lift of $w\in W$,
and \[g\in BwB := B\tilde{w} B.\]
The double coset $BwB$ is well-defined because $T = \ker(N\to W)\subset B$.
Note that \[B = \{g\in G\mid gx = x,\forall x\in c\}\] as $G$ is type-preserving,
so we have $B\subset P_{S'} = \stab_{G}(a)$.
Hence $\tilde{w}\in P_{S'}$,
and $w\in\stab_{W}(a) = W'$.
This shows that \[P_{S'} = \bigcup_{w\in W'}BwB = BW'B.\]
These double cosets are disjoint by \cref{Bruhat decomposition},
and we will focus on the three special cases:\begin{itemize}
\item the stabilizer of the empty face, $G = P_{S}$,
\item the stabilizer of a vertex, $K = P_{S \sminus \{s\}}$ for some $s\in S$, and
\item the stabilizer of a facet, $P_s$ for some $s\in S$. Since $s$ is a reflection, $P_s = B\cup BsB$.
\end{itemize}
\begin{theorem}[Bruhat decomposition]\label{Bruhat decomposition}
    The double cosets $BwB$ are disjoint for $w\in W$.
    In particular, \[G = BW\!B = \bigsqcup_{w\in W}BwB.\]
\end{theorem}
\begin{proof}
    In the above construction, $b\in B$ induces
    an isomophism $b|_{\A'} : \A'\to\A$ fixing $c$.
    By the unicity of canonical retractions from \cref{basic properties of a building},
    \[b|_{\A'} = \rho|_{\A'},\quad \rho = \rho_{\A, c}.\]
    So for each $g\in G$,
    we have shown that $g\in B\bar{\rho}(g) B$,
    where $\bar{\rho}(g)\in W$ is the unique element such that $\bar{\rho}(g)c = \rho(gc)$.

    Now we need to show that for any $w\in W$ and $g\in BwB$, $\bar{\rho}(g) = w$.
    Write $g = b\tilde{w}b'$ with $\tilde{w}\in N$ lifting $w$ and $b, b'\in B$.
    Then $gc = bwc\subset b\A$.
    Now $b^{-1}$ is an isomophism $b\A\to \A$ fixing $c$,
    so $\rho(gc) = b^{-1}gc = wc$,
    i.e. $\bar{\rho}(g) = w$. \textit{The proof seems to be tautologic...}
\end{proof}

Out next goal is the Cartan decomposition $G = K\!AK$.

\begin{theorem}\label{correspondence between double cosets of G and W}
    Let $S_1, S_2\subset S$, $W_i = \gene{S_i}$, $P_i = P_{S_i}$.
    Then there is a bijection \[\bico{W}{W_1}{W_2}\leftrightarrow\bico{G}{P_1}{P_2} \]
    given by $W_1wW_2\mapsto P_1wP_2$.
\end{theorem}

\begin{theorem}[Cartan decomposition]\label{Cartan decomposition}
    $G = K\!AK$.
\end{theorem}

\section{The Building for \texorpdfstring{$\SL_n$}{PDFstring}}
Let $V$ be a $(d + 1)$-dimensional $k$-vector space.
Let $q := \# (k^\circ/k^{\circ\circ})$.
We consider the group \[G := \SL(V, k)\simeq\SL_{d+1}(k).\]

Define \[\mathscr{N}(V, k) := \{\text{ultrametric norms } \norm{\cdot} : V\to k\}\]
and \[\mathscr{X}(V, k) := \frac{\mathscr{N}(V, k)}{\norm{\cdot}\simeq\norm{\cdot}'\iff \exists c\in\R_{>0}, \norm{\cdot} = c\norm{\cdot}'}.\]
Every norm on $V$ takes the following form.
\begin{itemize}
    \item Let $e = (e_0, \dots, e_d)$ be a basis of $V$, $c = (c_0, \dots, c_d)\in\R^{d+1}$ be parameters,
    then \[\norm{\cdot}_{e, c} : x = \sum_{i}\lambda_ie_i\mapsto\max_i q^{c_i}|\lambda_i| \]
    is a norm on $V$.
    The norms $\norm{\cdot}_{e, c}$ and $\norm{\cdot}_{e, c'}$ are homothetic if and only if $c - c'\in\R\cdot\mathbf{1}$.
    \item In particular, a basis $e$ of $V$ corresponds to a $k^\circ$-lattice $L = \sum_{i} k^\circ e_i$ in $V$,
    and the norm \[\norm{\cdot}_{e, \mathbf{0}} = \norm{\cdot}_{L} : x\mapsto \inf\{|\lambda| \mid \lambda\in k^\times,\ \lambda^{-1}x\in L\}.\]
\end{itemize}
\begin{proposition}\label{diagonalizability of norms}
    All (ultrametric) norms on $V$ are of the form $\norm{\cdot}_{e, c}$ for some basis $e$ and parameters $c\in\R^{d+1}$.
    Moreover, for any two norms $\norm{\cdot}$ and $\norm{\cdot}'$ on $V$,
    there is some basis $e$ of $V$ and parameters $c, c'\in\R^{d+1}$,
    such that \[\norm{\cdot} = \norm{\cdot}_{e, c},\quad \norm{\cdot}' = \norm{\cdot}_{e, c'}.\]
\end{proposition}
For a basis $e$ of $V$,
we define \begin{align*}
    \tilde{\A}_e &:= \{\norm{\cdot}_{e, c}\mid c\in\R^{d+1}\}\simeq \R^{d+1}\\
    \A_e &:= \tilde{\A}_e/\text{homothety} \simeq \R^{d+1}/\R\cdot\mathbf{1}.
\end{align*}
\cref{diagonalizability of norms} says that any two norms are contained in a same subset $\tilde{\A}_e$.

The group $\GL(V, k)\simeq\GL_{d + 1}(k)$ acts on $\mathscr{N}(V, k)$ by \[g\norm{\cdot} := \norm{\cdot}\circ g^{-1}.\]
Fix a basis $e$ of $V$.
It is plain to verify that \[g\norm{\cdot}_{e, c} = \norm{\cdot}_{ge, c}.\]
We admit the following facts. \begin{itemize}
    \item The above action induces an action of $G = \SL(V, k)$ on the space $\mathscr{X}(V, k)$, making the latter the affine Bruhat-Tits building for $G$. The appartments are given by $\tilde{\A}_e$'s and vertices are given by (homothety classes of) lattices, or $\norm{\cdot}_{e, 0}$'s.
    \item The (affine) Weyl group is
    \[W \simeq \mathfrak{S}_d\ltimes \Z^d,\] and \[N := \stab_{G}(\tilde\A_e) = \{\text{monomial matrices in base }e\text{ of determinant 1}\}.\]
    These implies that \[T := \ker(N\to W) =\{\text{diagonal matrices in base }e\text{ in }\SL_{d + 1}(k^\circ)\}\simeq ((k^\circ)^\times)^d.\]
    % \item For a point $\norm{\cdot}_{e, c}\in\mathscr{N}(V, k)$,
    % \[\stab_{\GL(V, k)}(\norm{\cdot}_{e, c}) = \left\{g = (g_{ij})\text{ in base }e \left|\, \det(g)\in (k^\circ)^\times,\ \log_{q}|g_{ij}|\le c_j - c_i\right.\right\}.\]
    \item Pick a vertex $x = [\norm{\cdot}_{e, 0}]\in\mathscr{X}(V, k)$. The subset \[C := \{[\norm{\cdot}_{e, c}]\mid c_0\le c_1\le\dots\le c_d\le 1 + c_0\}\] of the appartment $\tilde\A_e$ is an alcove. We call it the \textbf{standard alcove} attached to $x$ and $e$.
\end{itemize}
Now we compute some special groups of $G$.
\begin{itemize}
    \item The stabilizer of $x = [\norm{\cdot}_{e, c}]$ is the maximal compact \[K = \stab_G(x) = \stab_G(e) = \SL_{d+1}(k^\circ)\text{ in base }e.\]
    Then inclusion ``$\supset$'' is clear, so we only need to show that: an element $g\in\SL_{d+1}(k)$ stabilizes a homothety class of a lattice if and only if it stabilizes the lattice itself.
    If \[g\norm{\cdot}_{e, 0} = \norm{\cdot}_{ge, 0} = \norm{\cdot}_{e, c\cdot\mathbf{1}}\]for some $c\in\R$, then $c\in\Z$ (by hand or by type-preserving), so $ge = \varpi^ce$.
    In particular, $\det(g) = \det(\varpi^c)$,
    and hence $c = 0$. 
    \item The stabilizer of $C$ is the standard Iwahori
    \[B = \stab_{G}(C) = \begin{pmatrix}
        (k^\circ)^\times & k^\circ & \cdots & k^\circ\\
        \varpi k^\circ & (k^\circ)^\times & \cdots & k^\circ\\
        \vdots & \vdots & \ddots & \vdots\\
        \varpi k^\circ & \varpi k^\circ & \cdots & (k^\circ)^\times
    \end{pmatrix}\text{ in base }e.\]
    The group $B$ contains precisely the elements fixing the vertices of $C$.
    Let $gx\in c$ be another vertex,
    i.e. $\norm{\cdot}_{ge, 0} = \norm{\cdot}_{e, c}$ for a suitable $c\in\R^{d+1}$.
    Such $c$ must in $\Z^{d+1}$,
    
\end{itemize}

Cartan decomposition for $\SL_{d+1}$:
guess: \[\bico{(S_d\times\Z^d)}{S_d}{S_d} = \Z^d/S_d = \left\{ 
    \left.\begin{pmatrix}
        \varpi^{a_1} & & \\ & \ddots & \\ &  &\varpi^{a_d}
    \end{pmatrix}\right| a_1\ge \cdots\ge a_d
 \right\}.\]




\end{document}